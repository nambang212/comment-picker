<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giveaway Picker Otomatis</title>
    <!-- Library untuk efek suara -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Light background */
        }
        .confetti-piece {
            position: absolute;
            width: 8px;
            height: 16px;
            background: #3b82f6;
            top: 0;
            opacity: 0;
            animation: confetti-fall 3s ease-out forwards;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-10vh) rotateZ(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotateZ(720deg); opacity: 0; }
        }
        .modal-overlay {
            transition: opacity 0.3s ease;
        }
        .modal-box {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        #slot-machine-text {
            transition: transform 0.1s ease-out;
        }
        .summary-item {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 text-gray-800">

    <div class="w-full max-w-5xl mx-auto">
        <main id="mainGrid" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Kolom Kontrol (Kiri) -->
            <div id="settingsPanel" class="bg-white rounded-2xl shadow-lg p-6 md:p-8 relative">
                <div class="mb-6">
                    <h1 class="text-3xl font-extrabold text-gray-800">Giveaway Picker Otomatis</h1>
                </div>

                <div class="space-y-5">
                    <div>
                        <label for="postLink" class="block text-sm font-semibold text-gray-700 mb-2">1. Link Postingan Instagram</label>
                        <input type="text" id="postLink" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="https://www.instagram.com/p/...">
                    </div>

                    <div>
                        <label for="mentionCount" class="block text-sm font-semibold text-gray-700 mb-2">2. Minimal Mention Teman</label>
                        <input type="number" id="mentionCount" value="3" min="0" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500" placeholder="Contoh: 3">
                    </div>

                    <div>
                        <label for="winnerCount" class="block text-sm font-semibold text-gray-700 mb-2">3. Jumlah Pemenang</label>
                        <input type="number" id="winnerCount" value="1" min="1" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500">
                    </div>
                </div>

                <div class="mt-8 flex flex-col sm:flex-row gap-3">
                    <button id="pickButton" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200 transform hover:scale-105 flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>
                        <span id="pickButtonText">Mulai Undian</span>
                    </button>
                    <button id="resetButton" class="w-full sm:w-auto bg-gray-200 text-gray-700 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 transition-colors">
                        Reset
                    </button>
                </div>
            </div>

            <!-- Kolom Hasil (Kanan) -->
            <div id="results-panel" class="bg-white rounded-2xl shadow-lg p-6 md:p-8 flex flex-col items-center justify-center min-h-[400px] relative overflow-hidden">
                <div id="confetti-container"></div>
                <div id="messageBox" class="w-full"></div>
                <div id="initial-state" class="text-center">
                     <svg class="mx-auto h-24 w-24 text-indigo-200" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                    </svg>
                    <h3 class="mt-4 text-lg font-semibold text-gray-700">Pemenang Akan Muncul di Sini</h3>
                    <p class="mt-1 text-sm text-gray-500">Isi data di samping dan mulai undian.</p>
                </div>
                 <div id="loading-state" class="hidden text-center w-full">
                    <div class="loader mx-auto"></div>
                    <h3 class="text-xl font-semibold text-gray-500 mt-4">Mengambil data komentar...</h3>
                    <p class="text-sm text-gray-400">Proses ini mungkin memakan waktu beberapa saat.</p>
                </div>
                <div id="drawing-state" class="hidden text-center w-full">
                    <h3 class="text-xl font-semibold text-gray-500 mb-4">Mengundi Pemenang...</h3>
                    <div class="h-24 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden">
                        <p id="slot-machine-text" class="text-3xl font-bold text-indigo-600"></p>
                    </div>
                </div>
                <!-- Tempat untuk rekap pemenang -->
                <div id="summary-container" class="w-full hidden"></div>
            </div>
        </main>

    <!-- Winner Modal -->
    <div id="winnerModal" class="modal-overlay fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none">
        <!-- Konten Modal akan diisi oleh JavaScript -->
    </div>

    <script>
        // --- GLOBAL STATE ---
        let allParticipants = [];
        let drawnWinners = [];
        let remainingParticipants = [];
        let totalWinnerCount = 0;
        let currentWinnerIndex = 0;
        let isAudioReady = false;

        // --- DOM Element Selection ---
        const postLinkInput = document.getElementById('postLink');
        const mentionCountInput = document.getElementById('mentionCount');
        const winnerCountInput = document.getElementById('winnerCount');
        const pickButton = document.getElementById('pickButton');
        const pickButtonText = document.getElementById('pickButtonText');
        const resetButton = document.getElementById('resetButton');
        const messageBox = document.getElementById('messageBox');
        const initialState = document.getElementById('initial-state');
        const loadingState = document.getElementById('loading-state');
        const drawingState = document.getElementById('drawing-state');
        const summaryContainer = document.getElementById('summary-container');
        const slotMachineText = document.getElementById('slot-machine-text');
        const confettiContainer = document.getElementById('confetti-container');
        const winnerModal = document.getElementById('winnerModal');

        // --- Inisialisasi Audio ---
        let drum, cymbal;
        function setupAudio() {
            if (isAudioReady) return;
            drum = new Tone.MembraneSynth().toDestination();
            cymbal = new Tone.MetalSynth({
                frequency: 200,
                envelope: { attack: 0.001, decay: 0.4, release: 0.2 },
                harmonicity: 5.1,
                modulationIndex: 32,
                resonance: 4000,
                octaves: 1.5
            }).toDestination();
            isAudioReady = true;
        }

        // --- Event Listeners ---
        pickButton.addEventListener('click', startGiveaway);
        resetButton.addEventListener('click', resetApp);
        
        winnerModal.addEventListener('click', function(event) {
            const targetId = event.target.id;
            if (targetId === 'modalCloseBtn') closeModal();
            if (targetId === 'modalGoToCommentBtn') goToComment(event.target.dataset.commentId);
            if (targetId === 'modalNextBtn') viewNextWinner();
            if (targetId === 'modalRepickBtn') repickWinner();
        });

        async function startGiveaway() {
            if (!isAudioReady && typeof Tone !== 'undefined') {
                try {
                    await Tone.start();
                    setupAudio();
                } catch (e) {
                    console.error("Audio could not be initialized.", e);
                    isAudioReady = false;
                }
            }

            messageBox.innerHTML = '';
            summaryContainer.classList.add('hidden');
            
            const postUrl = postLinkInput.value;
            if (!postUrl || !postUrl.includes('instagram.com/p/')) {
                displayMessage('error', 'Silakan masukkan link postingan Instagram yang valid.');
                return;
            }
            
            totalWinnerCount = parseInt(winnerCountInput.value, 10);
            if (isNaN(totalWinnerCount) || totalWinnerCount < 1) {
                displayMessage('error', 'Jumlah pemenang harus diisi dengan angka (minimal 1).');
                return;
            }

            // --- TAHAP 1: MENGAMBIL DATA DARI BACKEND ---
            setLoading(true);
            try {
                // Panggil Netlify Function
                const response = await fetch('/.netlify/functions/get-comments', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ postUrl: postUrl })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Gagal mengambil data: Status ${response.status}`);
                }

                const rawParticipants = await response.json();
                
                // --- TAHAP 2: FILTER DAN PROSES DATA ---
                allParticipants = filterParticipants(rawParticipants);

                if (allParticipants.length === 0) {
                    throw new Error('Tidak ada komentar yang memenuhi syarat.');
                }

                if (allParticipants.length < totalWinnerCount) {
                    displayMessage('warning', `Hanya ada ${allParticipants.length} peserta yang valid, tidak cukup untuk memilih ${totalWinnerCount} pemenang.`);
                    setLoading(false);
                    return;
                }
                
                // --- TAHAP 3: MULAI UNDIAN ---
                const shuffled = shuffleArray([...allParticipants]);
                drawnWinners = shuffled.slice(0, totalWinnerCount);
                remainingParticipants = shuffled.slice(totalWinnerCount);
                currentWinnerIndex = 0;

                runDrawingAnimation(() => {
                    displayWinnerInModal(drawnWinners[currentWinnerIndex]);
                    setLoading(false);
                });

            } catch (error) {
                console.error("Error during giveaway:", error);
                displayMessage('error', error.message);
                setLoading(false);
            }
        }
        
        function filterParticipants(data) {
            const minMentions = parseInt(mentionCountInput.value, 10) || 0;
            const filteredUsers = new Map();

            data.forEach(user => {
                if (typeof user !== 'object' || user === null) return;

                const username = user.username ? String(user.username).trim() : null;
                const comment = user.komentar ? String(user.komentar).trim() : null;
                
                if (!username || !comment || filteredUsers.has(username.toLowerCase())) return;
                if (comment.startsWith('@')) return; // Abaikan balasan

                const mentionCount = (comment.match(/@/g) || []).length;
                
                if (mentionCount >= minMentions) {
                    filteredUsers.set(username.toLowerCase(), { 
                        username: username, 
                        comment: comment, 
                        profile_pic_url: user.profile_pic_url, 
                        comment_id: user.comment_id 
                    });
                }
            });
            
            return Array.from(filteredUsers.values());
        }
        
        function setLoading(isLoading) {
            if (isLoading) {
                pickButton.disabled = true;
                pickButton.classList.add('opacity-50', 'cursor-not-allowed');
                pickButtonText.textContent = 'Memproses...';
                initialState.classList.add('hidden');
                loadingState.classList.remove('hidden');
            } else {
                pickButton.disabled = false;
                pickButton.classList.remove('opacity-50', 'cursor-not-allowed');
                pickButtonText.textContent = 'Mulai Undian';
                loadingState.classList.add('hidden');
            }
        }

        function viewNextWinner() {
            closeModal(() => {
                currentWinnerIndex++;
                runDrawingAnimation(() => {
                    displayWinnerInModal(drawnWinners[currentWinnerIndex]);
                }, 3000);
            });
        }
        
        function repickWinner() {
            if (remainingParticipants.length === 0) {
                displayMessage('warning', "Tidak ada peserta lain yang tersisa untuk dipilih ulang.");
                return;
            }
            closeModal(() => {
                const newWinner = remainingParticipants.shift();
                drawnWinners[currentWinnerIndex] = newWinner;
                runDrawingAnimation(() => {
                    displayWinnerInModal(newWinner);
                }, 4000);
            });
        }

        function runDrawingAnimation(callback, duration = 5000) {
            initialState.classList.add('hidden');
            loadingState.classList.add('hidden');
            drawingState.classList.remove('hidden');

            let drumInterval = setInterval(() => {
                if(isAudioReady) drum.triggerAttackRelease("C1", "8n");
            }, 150);

            let animationInterval = setInterval(() => {
                const randomIndex = Math.floor(Math.random() * allParticipants.length);
                slotMachineText.textContent = allParticipants[randomIndex].username;
            }, 100);

            setTimeout(() => {
                clearInterval(animationInterval);
                clearInterval(drumInterval);
                if(isAudioReady) cymbal.triggerAttackRelease("C4", "1n");
                
                drawingState.classList.add('hidden');
                if (callback) {
                    callback();
                }
            }, duration);
        }
        
        function displayWinnerInModal(winnerData) {
            const { username, comment, profile_pic_url, comment_id } = winnerData;
            const fallbackAvatar = `https://ui-avatars.com/api/?name=${username.charAt(0)}&background=random&color=fff&size=96&bold=true`;
            
            const winnerPosition = currentWinnerIndex + 1;

            const showNextBtn = currentWinnerIndex < totalWinnerCount - 1;
            const showRepickBtn = remainingParticipants.length > 0;

            const modalContent = `
                <div class="modal-box bg-white w-full max-w-md rounded-2xl shadow-xl p-6 text-center transform scale-95 opacity-0">
                    <div class="flex justify-between items-center mb-4">
                         <h2 class="text-xl font-bold text-gray-800">Pemenang #${winnerPosition}</h2>
                         <button id="modalCloseBtn" class="text-gray-400 hover:text-gray-600 text-3xl leading-none">&times;</button>
                    </div>
                    <img src="${profile_pic_url || fallbackAvatar}" onerror="this.onerror=null;this.src='${fallbackAvatar}';" class="w-24 h-24 rounded-full mx-auto border-4 border-white shadow-lg bg-gray-200" alt="Avatar Pemenang">
                    <h3 class="text-2xl font-bold text-indigo-600 mt-4">${username}</h3>
                    <p class="text-gray-600 mt-2 px-4 h-20 overflow-y-auto text-sm">"${comment}"</p>
                    <div class="mt-6 grid grid-cols-2 gap-3">
                        <button id="modalGoToCommentBtn" data-comment-id="${comment_id || ''}" class="w-full bg-purple-500 text-white font-semibold py-2.5 px-4 rounded-lg hover:bg-purple-600 transition-colors">Lihat Komentar</button>
                        <a href="https://www.instagram.com/${username}/" target="_blank" rel="noopener noreferrer" class="w-full bg-blue-500 text-white font-semibold py-2.5 px-4 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center">Lihat Profil</a>
                    </div>
                    <div class="mt-3 grid ${showNextBtn || showRepickBtn ? (showNextBtn && showRepickBtn ? 'grid-cols-2' : 'grid-cols-1') : 'hidden'} gap-3">
                         ${showRepickBtn ? `<button id="modalRepickBtn" class="w-full bg-red-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-600 transition-colors">Ganti Pemenang</button>` : ''}
                         ${showNextBtn ? `<button id="modalNextBtn" class="w-full bg-indigo-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-600 transition-colors">Pemenang Berikutnya</button>` : ''}
                    </div>
                </div>
            `;
            winnerModal.innerHTML = modalContent;
            
            openModal();
        }

        function displayWinnerSummary() {
            initialState.classList.add('hidden');
            drawingState.classList.add('hidden');
            summaryContainer.classList.remove('hidden');

            let html = `
                <div class="flex justify-between items-center w-full mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">🏆 Rekap Pemenang 🏆</h2>
                    <button id="downloadBtn" class="bg-green-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        Download
                    </button>
                </div>
            `;
            html += '<div class="space-y-3 max-h-[350px] overflow-y-auto pr-2">';
            
            drawnWinners.forEach((winner, index) => {
                const winnerPosition = index + 1;
                const fallbackAvatar = `https://ui-avatars.com/api/?name=${winner.username.charAt(0)}&background=random&color=fff&size=40&bold=true`;
                html += `
                    <div class="summary-item flex items-center bg-gray-50 p-3 rounded-lg border border-gray-200" style="opacity:0; animation-delay: ${index * 100}ms;">
                        <span class="flex items-center justify-center h-8 w-8 rounded-full bg-gray-200 text-gray-700 font-bold mr-3">#${winnerPosition}</span>
                        <img src="${winner.profile_pic_url || fallbackAvatar}" onerror="this.onerror=null;this.src='${fallbackAvatar}';" class="w-10 h-10 rounded-full mr-3 bg-gray-200">
                        <div class="flex-grow">
                             <a href="https://www.instagram.com/${winner.username}/" target="_blank" rel="noopener noreferrer" class="font-semibold text-indigo-600 hover:underline">
                                ${winner.username}
                            </a>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            summaryContainer.innerHTML = html;
            
            document.getElementById('downloadBtn').addEventListener('click', downloadSummaryAsDoc);
        }

        function downloadSummaryAsDoc() {
            let content = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset='utf-8'><title>Rekap Pemenang Giveaway</title></head>
                <body>
                    <h1>Rekap Pemenang Giveaway</h1>
                    <p><strong>Link Postingan:</strong> <a href="${postLinkInput.value}">${postLinkInput.value || 'Tidak dicantumkan'}</a></p>
                    <table border="1" style="width:100%; border-collapse: collapse; font-family: sans-serif;">
                        <thead>
                            <tr style="background-color: #f2f2f2;">
                                <th style="padding: 8px; text-align: left;">Pemenang Ke-</th>
                                <th style="padding: 8px; text-align: left;">Username</th>
                                <th style="padding: 8px; text-align: left;">Komentar</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            drawnWinners.forEach((winner, index) => {
                const winnerPosition = index + 1;
                const commentLink = getCommentLink(winner.comment_id);
                content += `
                    <tr>
                        <td style="padding: 8px; text-align: center;">${winnerPosition}</td>
                        <td style="padding: 8px;"><a href="https://www.instagram.com/${winner.username}/">${winner.username}</a></td>
                        <td style="padding: 8px;"><a href="${commentLink}">${winner.comment}</a></td>
                    </tr>
                `;
            });

            content += `
                        </tbody>
                    </table>
                </body>
                </html>
            `;

            const blob = new Blob(['\ufeff', content], {
                type: 'application/msword'
            });
            
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = "rekap-pemenang.doc";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function getCommentLink(commentId) {
            const link = postLinkInput.value;
            if (!link || !commentId) {
                return '#';
            }
            const shortcodeMatch = link.match(/\/p\/([a-zA-Z0-9_-]+)/);
            if (shortcodeMatch && shortcodeMatch[1]) {
                const shortcode = shortcodeMatch[1];
                return `https://www.instagram.com/p/${shortcode}/c/${commentId}/`;
            }
            return link;
        }

        function goToComment(commentId) {
            const commentLink = getCommentLink(commentId);
            if (commentLink === '#') {
                displayMessage('error', 'Link postingan atau ID komentar tidak valid.');
                return;
            }
            window.open(commentLink, '_blank');
        }

        function openModal() {
            winnerModal.classList.remove('opacity-0', 'pointer-events-none');
            setTimeout(() => {
                winnerModal.querySelector('.modal-box').classList.remove('scale-95', 'opacity-0');
            }, 10);
            triggerConfetti();
        }

        function closeModal(callback) {
            if (winnerModal.querySelector('.modal-box')) {
                winnerModal.querySelector('.modal-box').classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    winnerModal.classList.add('opacity-0', 'pointer-events-none');
                    
                    if (!callback && drawnWinners.length > 0 && currentWinnerIndex >= totalWinnerCount - 1) {
                        displayWinnerSummary();
                    }

                    if (callback) {
                        callback();
                    }
                }, 300);
            }
        }

        function resetApp() {
            postLinkInput.value = '';
            mentionCountInput.value = '3';
            winnerCountInput.value = '1';
            messageBox.innerHTML = '';
            initialState.classList.remove('hidden');
            drawingState.classList.add('hidden');
            loadingState.classList.add('hidden');
            summaryContainer.classList.add('hidden');
            confettiContainer.innerHTML = '';
            allParticipants = [];
            drawnWinners = [];
            remainingParticipants = [];
            currentWinnerIndex = 0;
            totalWinnerCount = 0;
            setLoading(false);
            closeModal();
        }

        function displayMessage(type, message) {
            initialState.classList.add('hidden');
            let bgColor = type === 'error' ? 'bg-red-100' : 'bg-yellow-100';
            let textColor = type === 'error' ? 'text-red-800' : 'text-yellow-800';
            let borderColor = type === 'error' ? 'border-red-400' : 'border-yellow-400';
            messageBox.innerHTML = `<div class="${bgColor} border-l-4 ${borderColor} ${textColor} p-4 rounded-lg" role="alert"><p class="font-semibold">${message}</p></div>`;
            drawingState.classList.add('hidden');
            loadingState.classList.add('hidden');
            setTimeout(() => {
                messageBox.innerHTML = '';
                initialState.classList.remove('hidden');
            }, 5000);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function triggerConfetti() {
            confettiContainer.innerHTML = '';
            for (let i = 0; i < 100; i++) {
                const confettiPiece = document.createElement('div');
                confettiPiece.className = 'confetti-piece';
                confettiPiece.style.left = `${Math.random() * 100}%`;
                confettiPiece.style.animationDelay = `${Math.random() * 3}s`;
                confettiPiece.style.backgroundColor = `hsl(${210 + Math.random() * 40}, 100%, 60%)`;
                confettiContainer.appendChild(confettiPiece);
            }
        }
    </script>
</body>
</html>

